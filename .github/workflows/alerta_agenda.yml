# .github/workflows/alerta_agenda.yml

name: Alerta de Agenda DiÃ¡rio (Cron Job)

# 1. GATILHOS
on:
  # Agendamento AutomÃ¡tico (CRON JOB)
  schedule:
    # Roda diariamente Ã s 10h, 14h, 18h e 22h UTC (corresponde a 7h, 11h, 15h e 19h no Brasil/GMT-3)
    - cron: '0 10,14,18,22 * * *' 

  # ðŸ“Œ ATIVAÃ‡ÃƒO MANUAL PARA TESTES
  workflow_dispatch: 
  
# --- TRABALHO DE EXECUÃ‡ÃƒO ---
jobs:
  run_alerta:
    runs-on: ubuntu-latest
    
    steps:
    # 1. Checkout do CÃ³digo
    - name: Checkout do RepositÃ³rio
      uses: actions/checkout@v4

    # 2. Configura o Python
    - name: Configura Python 3.11
      uses: actions/setup-python@v5
      with:
        python-version: '3.11'
    
    # 3. Instala DependÃªncias
    - name: Instala DependÃªncias
      run: pip install -r requirements.txt
    
    # 4. Executa o Script de Alerta (O Agente)
    - name: Executa o Alerta
      run: python alerta_eventos.py
      env:
        TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
        TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        GSPREAD_CREDENTIALS_JSON: ${{ secrets.GSPREAD_CREDENTIALS_JSON }}
